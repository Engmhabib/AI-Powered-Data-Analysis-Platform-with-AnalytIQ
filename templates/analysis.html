<!-- templates/analysis.html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Analysis Results</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <h1>Analysis Results</h1>

    <h2>Commentary</h2>
    <p>{{ commentary }}</p>

    <h2>Visualization</h2>
    <!-- Embed Plotly Visualization -->
    {% if graphJSON %}
        <div id="plotly-div"></div>
        <script>
            // Ensure the graphJSON is properly escaped and safe for embedding
            var graphData = {{ graphJSON | safe }};
            Plotly.newPlot('plotly-div', graphData);
        </script>
    {% else %}
        <p>No visualization available.</p>
    {% endif %}

    <!-- Analysis Details Section (unchanged) -->
    <!-- ... rest of your existing code ... -->

    <a href="{{ url_for('index') }}">Perform Another Analysis</a>
</body>
</html>
